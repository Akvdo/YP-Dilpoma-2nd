
/* Задание 2
Чтобы протестировать статусы заказов, нужно убедиться, что в базе данных они записываются корректно.
Для этого выводим все трекеры заказов и их статусы.
Статусы определяются по следующему правилу:
Если поле finished == true, то вывести статус 2.
Если поле canсelled == true, то вывести статус -1.
Если поле inDelivery == true, то вывести статус 1.
Для остальных случаев вывести 0. */

SELECT  track AS "Orders", -- определяем для выборки первое поле "Заказ", в котором будут записаны треки заказов
        CASE -- с помощью оператора CASE определяем для наших заказов правила, определяющие статус
            WHEN finished = true THEN 2 -- первое условие
            WHEN cancelled = true THEN -1 -- второе условие
            WHEN "inDelivery" = true THEN 1 -- третье условие
            WHEN finished != true AND cancelled != true AND "inDelivery" != true THEN 0 -- остальные случаи
        END as "Status" -- определяем второе поле "Статус" для выборки, в котором будут записаны статусы заказов
FROM "Orders"; -- таблица с заказами, из которой делаем выгрузку

/* Пример ответа:
 Orders | Status
--------+--------
 837477 | 2
 214092 | 1
  18442 | 2
 450660 | 2
 556939 | 2
  20095 | 0
 129474 | 0
 617922 | 0
 891852 | 0
  78415 | 0
(10 rows)
 */